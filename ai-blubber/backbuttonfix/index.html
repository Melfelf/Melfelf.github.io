<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  
  
    
  
  <meta name="description" content="Fixing the back button behavior to properly use browser history when appropriate">

  <title>Back Button Fix</title>
  <link rel="icon" type="image/png" sizes="32x32" href="https://melf.ch/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://melf.ch/img/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://melf.ch/img/apple-touch-icon.png">
  
  <style>

  /* light mode colors */
  body {
    --primary-color: #5871a2;
    --primary-pale-color: #5871a233;
    --primary-decoration-color: #5871a210;
    --bg-color: #ffffff;
    --text-color: #2f3030;
    --text-pale-color: #767676;
    --text-decoration-color: #a9a9a9;
    --highlight-mark-color: #5f75b020;

    --callout-note-color: #5871a2;
    --callout-tip-color: #268556;
    --callout-important-color: #885fc9;
    --callout-warning-color: #ab6632;
    --callout-caution-color: #c64e4e;
  }

  /* dark mode colors */
  body.dark {
    --primary-color: #6f8fd1;
    --primary-pale-color: #6f8fd166;
    --primary-decoration-color: #6f8fd112;
    --bg-color: #1c1c1c;
    --text-color: #c1c1c1;
    --text-pale-color: #848484;
    --text-decoration-color: #5f5f5f;
    --highlight-mark-color: #8296cb3b;

    --callout-note-color: #6f8fd1;
    --callout-tip-color: #47976f;
    --callout-important-color: #9776cd;
    --callout-warning-color: #ad7a52;
    --callout-caution-color: #d06161;
  }

  /* typography */
  body {
    --main-font: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
    --code-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
    --homepage-max-width: 768px;
    --main-max-width: 768px;
    --avatar-size: 60px;
    --font-size: 16px;
    --line-height: 1.75;
    --img-border-radius: 0px;
    --detail-border-radius: 0px;
    --dark-mode-img-brightness: 0.75;
    --dark-mode-chart-brightness: 0.75;
    --inline-code-border-radius: 2px;
    --inline-code-bg-color: var(--primary-decoration-color);
    --block-code-border-radius: 0px;
    --block-code-border-color: var(--primary-color);
    --detail-border-color: var(--primary-color);
  }

</style>

  <link rel="stylesheet" href="https://melf.ch/main.css">
  

<link id="hl" rel="stylesheet" type="text/css" href="https://melf.ch/hl-light.css" />



  
</head>

<body class="post">
  
  <script>
    const theme = sessionStorage.getItem('theme');
    const match = window.matchMedia("(prefers-color-scheme: dark)").matches
    if ((theme && theme == 'dark') || (!theme && match)) {
      document.body.classList.add('dark');
      const hl = document.querySelector('link#hl');
      if (hl) hl.href = 'https://melf.ch/hl-dark.css';
    }
  </script>
  
  
<div id="wrapper">
  <div id="blank"></div>
  <aside>
    
    
    <nav>
      <ul>
        
        <li>
          <a class="h2" href="#problem-description">Problem Description</a>
          
        </li>
        
        <li>
          <a class="h2" href="#root-cause-analysis">Root Cause Analysis</a>
          
        </li>
        
        <li>
          <a class="h2" href="#solution-implementation">Solution Implementation</a>
          
          <ul>
            
            <li>
              <a class="h3" href="#1-modified-the-back-link-macro">1. Modified the Back Link Macro</a>
            </li>
            
            <li>
              <a class="h3" href="#2-updated-the-enablebacklink-function">2. Updated the enableBackLink Function</a>
            </li>
            
            <li>
              <a class="h3" href="#3-template-override">3. Template Override</a>
            </li>
            
          </ul>
          
        </li>
        
        <li>
          <a class="h2" href="#key-features-of-the-fix">Key Features of the Fix</a>
          
        </li>
        
        <li>
          <a class="h2" href="#testing">Testing</a>
          
          <ul>
            
            <li>
              <a class="h3" href="#quick-test-script">Quick Test Script</a>
            </li>
            
          </ul>
          
        </li>
        
      </ul>
    </nav>
    
    
    <button id="back-to-top" aria-label="back to top">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>

    </button>
    
  </aside>
  <main>
    
<header>
  <nav>
    <a id="back-link" href="#">← Back</a>
  </nav>
</header>


    <div>
      
      
      
      
      <div id="copy-cfg" style="display: none;" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
"></div>
      
      <article class="prose">
        <h1>Back Button Fix</h1>
        <div id="post-info">
          <div id="date">
            <span id="publish">Dec 21, 2025 at 00:00</span>
            </div>

          
          <div id="tags">
            <a class="instant" href="https://melf.ch/tags/javascript"><span>#</span>JavaScript</a><a class="instant" href="https://melf.ch/tags/ui-ux"><span>#</span>UI&#x2F;UX</a><a class="instant" href="https://melf.ch/tags/zola"><span>#</span>Zola</a><a class="instant" href="https://melf.ch/tags/serene-theme"><span>#</span>Serene Theme</a>
          </div>
          
        </div>

        
        

        

        <h2 id="problem-description">Problem Description<a class="zola-anchor" href="#problem-description" aria-label="Anchor link for: problem-description" style="visibility: hidden;"></a>
</h2>
<p>The back button on the website was not functioning correctly. Instead of navigating back in the browser history when appropriate, it always redirected to the blog section, regardless of the user's navigation path.</p>
<h2 id="root-cause-analysis">Root Cause Analysis<a class="zola-anchor" href="#root-cause-analysis" aria-label="Anchor link for: root-cause-analysis" style="visibility: hidden;"></a>
</h2>
<p>The issue was that the back button was implemented as a link to the section index (e.g., <code>/blog</code> for blog posts), with JavaScript to conditionally use <code>history.back()</code> only when the referrer was from the same site and met certain conditions. However, this led to inconsistent behavior where the button often fell back to the section index instead of navigating back in history.</p>
<h2 id="solution-implementation">Solution Implementation<a class="zola-anchor" href="#solution-implementation" aria-label="Anchor link for: solution-implementation" style="visibility: hidden;"></a>
</h2>
<h3 id="1-modified-the-back-link-macro">1. Modified the Back Link Macro<a class="zola-anchor" href="#1-modified-the-back-link-macro" aria-label="Anchor link for: 1-modified-the-back-link-macro" style="visibility: hidden;"></a>
</h3>
<p>Overrode the theme's macro to set the href to <code>#</code> instead of the section path:</p>
<pre data-lang="html" class="language-html "><code class="language-html" data-lang="html">{% macro back_link(path) %}
&lt;header&gt;
  &lt;nav&gt;
    &lt;a id=&quot;back-link&quot; href=&quot;#&quot;&gt;← {{ config.extra.back_link_text }}&lt;&#x2F;a&gt;
  &lt;&#x2F;nav&gt;
&lt;&#x2F;header&gt;
{% endmacro %}
</code></pre>
<h3 id="2-updated-the-enablebacklink-function">2. Updated the enableBackLink Function<a class="zola-anchor" href="#2-updated-the-enablebacklink-function" aria-label="Anchor link for: 2-updated-the-enablebacklink-function" style="visibility: hidden;"></a>
</h3>
<p>Changed the function to always prevent the default link behavior and use <code>history.back()</code>:</p>
<pre data-lang="javascript" class="language-javascript "><code class="language-javascript" data-lang="javascript">function enableBackLink() {
  const backLink = document.querySelector(&#x27;#back-link&#x27;);
  if (!backLink) return;
  backLink.addEventListener(&#x27;click&#x27;, (e) =&gt; {
    e.preventDefault();
    history.back();
  });
}
</code></pre>
<h3 id="3-template-override">3. Template Override<a class="zola-anchor" href="#3-template-override" aria-label="Anchor link for: 3-template-override" style="visibility: hidden;"></a>
</h3>
<p>Created <code>/templates/macros/prose.html</code> to override the theme's macro, ensuring the change applies to all pages using the back link.</p>
<h2 id="key-features-of-the-fix">Key Features of the Fix<a class="zola-anchor" href="#key-features-of-the-fix" aria-label="Anchor link for: key-features-of-the-fix" style="visibility: hidden;"></a>
</h2>
<ul>
<li><strong>Consistent Navigation</strong>: Always uses browser history for back navigation</li>
<li><strong>Fallback Handling</strong>: If there's no history to go back to, the button does nothing (graceful degradation)</li>
<li><strong>No Breaking Changes</strong>: Maintains the visual appearance and accessibility</li>
<li><strong>Performance</strong>: Lightweight implementation with minimal overhead</li>
</ul>
<h2 id="testing">Testing<a class="zola-anchor" href="#testing" aria-label="Anchor link for: testing" style="visibility: hidden;"></a>
</h2>
<p>The fix has been applied to ensure the back button now consistently navigates back in browser history across all pages, providing a more intuitive user experience.</p>
<h3 id="quick-test-script">Quick Test Script<a class="zola-anchor" href="#quick-test-script" aria-label="Anchor link for: quick-test-script" style="visibility: hidden;"></a>
</h3>
<ol>
<li>Navigate from the homepage to a blog post via a tag or search result.</li>
<li>Click the back button: expect to return to the referring list/search page.</li>
<li>Open a post directly in a new tab: back button should do nothing (no history), not dump you at <code>/blog</code>.</li>
<li>Repeat on mobile to verify tap targets and preventDefault behavior.</li>
</ol>

      </article>

      
      

      
      
    </div>

    


<footer>
  <div class="left">
    <div class="copyright">
      © 2025 by S.Moser
      
      <span>|</span>
      Built with <a href="https://www.getzola.org" rel="noreferrer" target="_blank">zola</a> and <a href="https://github.com/isunjn/serene" rel="noreferrer" target="_blank">serene</a>
      
    </div>
  </div>

  <div class="right">
    
    
      
    
    
    <a id="rss-btn" href="https://melf.ch/blog/atom.xml">RSS</a>
    
    

    
    
    
    <button id="theme-toggle" aria-label="theme switch">
      <span class="moon-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill="currentColor"></path></svg>
</span>
      <span class="sun-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill="currentColor"></path></svg>
</span>
    </button>
    
  </div>
</footer>




<dialog id="rss-mask">
  <div>
    <a href="https:&#x2F;&#x2F;melf.ch&#x2F;blog&#x2F;atom.xml">https:&#x2F;&#x2F;melf.ch&#x2F;blog&#x2F;atom.xml</a>
    
    
    <button autofocus aria-label="copy" data-link="https:&#x2F;&#x2F;melf.ch&#x2F;blog&#x2F;atom.xml" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>

    </button>
  </div>
</dialog>



  </main>
</div>

  
<script src="https://melf.ch/js/lightense.min.js"></script>


  <script src="https://melf.ch/js/main.js"></script>
</body>

</html>
